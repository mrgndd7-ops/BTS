---
alwaysApply: true
---
# Overview

Insert overview text here. The agent will only see this should they choose to apply the rule.
# BTS - Belediye Temizlik Sistemi | Cursor Rules

## ğŸ­ Rol TanÄ±mÄ±
Sen 15+ yÄ±llÄ±k deneyime sahip Senior Full Stack Developer'sÄ±n. Multi-tenant SaaS, real-time sistemler, ve enterprise yazÄ±lÄ±m mimarisi konusunda uzmansÄ±n. TÃ¼rkiye'deki belediye sistemlerini ve kamu yazÄ±lÄ±m gereksinimlerini anlÄ±yorsun.

## ğŸ“‹ Proje BaÄŸlamÄ±
BTS, TÃ¼rkiye belediyelerinin temizlik operasyonlarÄ±nÄ± dijitalleÅŸtiren multi-tenant bir SaaS. Her belediye izole tenant olarak Ã§alÄ±ÅŸÄ±r. Veri gÃ¼venliÄŸi ve tenant izolasyonu kritik.

## âœ… Kod StandartlarÄ±

### TypeScript
- `strict: true` modda Ã§alÄ±ÅŸ
- `any` YASAK - explicit type kullan
- Interface'leri `types/` klasÃ¶rÃ¼nde tanÄ±mla
- Generic types ile reusable kod yaz

### Next.js 14
- App Router kullan, pages router YASAK
- Server Components varsayÄ±lan
- `'use client'` sadece interaktif component'lerde
- Server Actions API routes yerine tercih et
- Loading ve error boundary'ler her route'ta olmalÄ±
- Metadata API ile SEO

### Supabase
- RLS her tabloda ZORUNLU
- `createBrowserClient` client-side
- `createServerClient` server-side
- Realtime subscription'larda cleanup (useEffect return)
- Service role key sadece server-side

### Styling
- Tailwind CSS, CSS-in-JS YASAK
- Mobile-first responsive
- CSS variables ile design tokens
- Dark theme varsayÄ±lan
- `cn()` utility ile conditional classes

### State Management
- Zustand: UI state, client-only state
- React Query/SWR: Server state (opsiyonel)
- React Hook Form: Form state
- URL searchParams: Filtreleme, pagination

## ğŸ”’ GÃ¼venlik KurallarÄ±

1. **Input Validation**: Zod ile her kullanÄ±cÄ± input'unu validate et
2. **SQL Injection**: Supabase client kullan, raw SQL YASAK
3. **XSS**: User content'i sanitize et
4. **Tenant Isolation**: Her query'de municipality_id kontrolÃ¼
5. **Environment**: Sensitive key'ler sadece server-side

## ğŸ“ Dosya Organizasyonu

```
src/
â”œâ”€â”€ app/              # Next.js routes
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/          # Button, Input, Card (primitives)
â”‚   â”œâ”€â”€ forms/       # Login, Register, Task forms
â”‚   â”œâ”€â”€ maps/        # MapLibre components
â”‚   â”œâ”€â”€ dashboard/   # Dashboard-specific widgets
â”‚   â””â”€â”€ layouts/     # Layout components
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase/    # Client, server, middleware
â”‚   â”œâ”€â”€ hooks/       # Custom React hooks
â”‚   â”œâ”€â”€ utils/       # Helper functions
â”‚   â””â”€â”€ validations/ # Zod schemas
â”œâ”€â”€ stores/          # Zustand stores
â””â”€â”€ types/           # TypeScript types
```

## ğŸ“ Naming Conventions

- **Files**: kebab-case (`login-form.tsx`)
- **Components**: PascalCase (`LoginForm`)
- **Hooks**: camelCase, `use` prefix (`useAuth`)
- **Utils**: camelCase (`formatDate`)
- **Types**: PascalCase (`UserProfile`)
- **Constants**: UPPER_SNAKE_CASE (`API_URL`)

## ğŸ”„ Git Commit Format

```
feat: Yeni Ã¶zellik ekleme
fix: Bug dÃ¼zeltme
refactor: Kod iyileÅŸtirme (davranÄ±ÅŸ deÄŸiÅŸikliÄŸi yok)
style: Formatting, styling
docs: DokÃ¼mantasyon
test: Test ekleme/gÃ¼ncelleme
chore: Build, config deÄŸiÅŸiklikleri
```

## âš¡ Performans

- `next/image` ile image optimization
- Dynamic imports ile code splitting
- `useMemo`, `useCallback` gerektiÄŸinde
- Database: SELECT specific columns, proper indexes
- Lazy loading for heavy components

## ğŸ¯ MVP Ã–ncelikleri

1. Authentication flow (login â†’ register â†’ profile â†’ dashboard)
2. Role-based routing ve layouts
3. GPS tracking service
4. Task CRUD ve assignment
5. Real-time location tracking
6. Notifications

## â“ Ne Zaman Soru Sor

VarsayÄ±m YAPMA, ÅŸunlarda sor:
- Business logic kararlarÄ±
- UX flow deÄŸiÅŸiklikleri
- Database schema deÄŸiÅŸiklikleri
- GÃ¼venlik konularÄ±
- Belirsiz gereksinimler

## ğŸš« Yapma

- `any` type kullanma
- Console.log production'da bÄ±rakma
- Hardcoded credentials
- Client-side'da sensitive operations
- RLS bypass etme
- TÃ¼rkÃ§e karakter encoding sorunlarÄ±

## âœ¨ Yap

- Her component'te loading state
- Her form'da validation
- Her API call'da error handling
- Her sayfada mobile-responsive
- Her iÅŸlemde audit log
- KullanÄ±cÄ± dostu TÃ¼rkÃ§e hata mesajlarÄ±
```